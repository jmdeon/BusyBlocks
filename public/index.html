<html ng-app="myApp" >
    <head>
        <!-- Information about the document goes here. This includes the encoding, title, css files, and JS files -->
        <link rel="stylesheet" type="text/css" href="./style.css">
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.0/angular-material.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">	
        <title>Scheduling App</title>


        <!-- Get access to the Parse library -->
		    <script type="text/javascript" src="https://parse.com/downloads/javascript/parse-1.4.2.js"></script>

        <!-- Load UI Calendar sources -->
        <link rel="stylesheet" href="lib/bower_components/fullcalendar/dist/fullcalendar.css"/>

        <!-- jquery, moment, and angular have to get included before fullcalendar -->
        <script type="text/javascript" src="lib/bower_components/jquery/dist/jquery.js"></script>
        <script type="text/javascript" src="lib/bower_components/moment/moment.js"></script>
        <script type="text/javascript" src="lib/bower_components/angular/angular.js"></script>
        <script type="text/javascript" src="lib/bower_components/angular-ui-calendar/src/calendar.js"></script>
        <script type="text/javascript" src="lib/bower_components/fullcalendar/dist/fullcalendar.js"></script>
        <script type="text/javascript" src="lib/bower_components/fullcalendar/dist/gcal.js"></script>

        <!-- Load BootStrap -->
        <script type="text/javascript" src="lib/ui-bootstrap-tpls-0.13.0.min.js"></script>

        <!-- Modules -->
        <script src="js/app.js"></script>
        <!-- Controllers -->
    	<script src="js/controllers/ProfileController.js"></script>
        <script src="js/controllers/GroupController.js"></script>
        <!-- Services -->
    	<script src="js/services/userService.js"></script>
    	<script src="js/services/groupService.js"></script>

        <!-- Inline JS goes here -->
        <script> 
            /** Global variables **/
            Parse.initialize( "t5hvXf3wJOYnL3MMIffsemMdhLM7f4brACcf0eBa", "UhqQaEDIEQr6cxhO8XS4Fl8BcGU4ir9jL9To7PVO" );
            var currentUser = Parse.User.current();
            if (currentUser) {
            	// do stuff with the user
            } 
            else {
            	// show the signup or login page
            	location.href = "login/login.html";
            }
            
        </script> 
    </head>
    
    <body>
      <!-- PROFILE CONTROLLER -->
      <div ng-controller="ProfileController"> 
        
        <script type="text/ng-template" id="myModalContent.html">
            <div class="modal-header">
                <h3 class="modal-title">Add a Friend</h3>
            </div>
            <div class="modal-body">
            	<label for="friendEmail">Friend&#39;s Email</label>
            	<input type="text" name="friendEmail">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" ng-click="ok()">OK</button>
                <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
            </div>
        </script>

        <script type="text/ng-template" id="friendList.html">
        	<div ng-controller="ProfileController">
	            <div class="modal-header">
	                <h3 class="modal-title">Your Friends</h3>
	            </div>
	            <div class="modal-body">
	                <ul>
	                    <li ng-repeat="friend in friendList track by $index">{{ friend.name }} ({{ friend.email }})</li>
	                </ul>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-primary" ng-click="ok()">OK</button>
	                <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
	            </div>
           	</div>
        </script>

        <script type="text/ng-template" id="settings.html">
            <div ng-controller="ProfileController">
                <div class="modal-header">
                    <h3 class="modal-title">Account Settings</h3>
                </div>
                <div class="modal-body">
                    <label>New UserName</label>
                    <input ng-model="newUserName"><br><br>
                    <label>New Email</label>
                    <input ng-model="newEmail"><br><br>
                    <label>New Password</label>
                    <input ng-model="newPassword"><br><br>
                    <button ng-click="settingsSave()">Save</button>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" ng-click="ok()">OK</button>
                    <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                </div>
            </div>
        </script>
          
        <div id="logoutWrapper">
            <div class="btn-group" dropdown>
                <div class="logoutbtn" ng-show="homeView" dropdown-toggle></div>
                    <ul class="dropdown-menu" role="menu">
                        <li><div ng-click="settingsModal('lg')">Account Settings</div></li>
                        <li><div ng-click="logout()">Logout</div></li>
                    </ul>
            </div>
            
            <div class="btn-group" dropdown>
                <div class = "friendsOptionsBtn" ng-show="homeView" dropdown-toggle></div>
                    <ul class="dropdown-menu" role="menu">
                        <li><div ng-click="open('lg')">Add Friend</div></li>
                        <li><div ng-click="friendsModal('lg')">View Friends List</div></li>
                    </ul>
            </div>
            
            <div id="greeting">Hi, {{ userName }}</div>
            <center>
                <div ng-click="profileView=true; groupView=false; $parent.singleGroupView=false" class="viewBtn">Profile</div>
                <div ng-click="groupView=true; profileView=false; $parent.singleGroupView=false" class="viewBtn">Groups</div>
            </center>
        </div>
    
        <div id="homeView" ng-init="homeView=true" ng-show="homeView">     
        	<div ng-init="profileView=true" ng-show="profileView" id="profileView">
            	<div id="profileWrapper">
                    <div id="scheduleWrapper">
                        <p id="yourSched">Your Schedule</p>
                
                        <div class="schedule">
                            <!-- TEST UI CALENDAR -->
                            <div  ng-model="eventSources" calendar='userCalendar' ui-calendar="uiConfig.calendar"  ></div>
                            <br><br>
                        </div>
                    </div>
                    
                    <div id="createWrapper">
                        <p id="createTitle">Create Event</p>
                        <div class="createEvent">
                            <label for="pEventName">Event Name</label>
                            <input type="text" name="pEventName" class="eventPar" ng-model="newEventName">
                            <br><br>

                            <label for="singleEvent">Single Event</label>
                            <label for="recurringEvent">Recurring Event</label>
                            <input type="radio" name="singleEvent" ng-click="singleEvent=true">
                            <input type="radio" name="recurringEvent" ng-click="singleEvent=false">
                            <br><br>

                            <label for="pStartTime" ng-show="singleEvent">Single Event Start Date</label>
                            <input ng-show="singleEvent" name="pStartDate" type="date" class="eventPar" ng-model="newSingleEventStartDate">
                            <br><br>
                            
                            <label for="pEndTime" ng-show="singleEvent">Single Event End Date</label>
                            <input ng-show="singleEvent" for="pEndDate" type="date" class="eventPar" ng-model="newSingleEventEndDate">
                            <br><br>

                            <p ng-show="singleEvent">Single Event Start Time</p>
                            <input ng-show="singleEvent" type="time" class="eventPar" ng-model="newSingleEventStartTime"><br><br>
                            
                            <p ng-show="singleEvent">Single Event End Time</p>
                            <input  ng-show="singleEvent" type="time" class="eventPar" ng-model="newSingleEventEndTime"><br><br>

                            <label for="pStartDate" ng-show="!singleEvent">Recurring Start Date</p>
                            <input  ng-show="!singleEvent" type="date" class="eventPar" ng-model="newRecurringEventStartDate"><br><br>

                            <label for="pEndTime" ng-show="!singleEvent">Recurring End Date</p>
                            <input  ng-show="!singleEvent" type="date" class="eventPar" ng-model="newRecurringEventEndDate"><br><br>
                            
                            <p ng-show="!singleEvent">Recurring Start Time</p>
                            <input ng-show="!singleEvent" type="time" class="eventPar" ng-model="newReccuringEventStartTime"><br><br>
                            
                            <p ng-show="!singleEvent">Recurring End Time</p>
                            <input  ng-show="!singleEvent" type="time" class="eventPar" ng-model="newReccuringEventEndTime"><br><br>

                            
                            <div ng-click="addEvent()" class="createButton" style="margin-top:10px;">Create</div>
                        </div>
                    </div>
            	</div>
        	</div>
            
        	<div ng-init="groupView=false" ng-show="groupView" id="groupView">
            	<div>
                    <div>
                        <label for="removedGroup">Selected group to remove:</label>
                        <select id="removedGroup" ng-model="removedGroup">
                            <option ng-repeat="group in myGroupList track by $index" value={{group.id}}>{{group.name}}</option>
                        </select>
                        <div ng-click="removeGroup()" class="btn2" style="margin-top:10px;">Remove Group</div>
                    </div>
                	<div ng-click="removeAllGroups()" class="btn2" style="margin-top:10px;">Remove ALL Group</div>
                	<ul>
                    	<div ng-repeat="group in myGroupList track by $index" class ="groupSelect"  
                        ng-click="$parent.profileView=false; 
                                  $parent.groupView=false; 
                                  $parent.$parent.singleGroupView=true; 
                                  $parent.currentGroupId = group.id; 
                                  $parent.currentGroupColor = group.color;
                                  addGroup();" ng-attr-title="{{ group.name }}" 
                    	ng-style="{background:group.color}">
                            <p>{{ group.name | limitTo:12 }}{{ group.name.length >= 12 ? '...' : '' }}</p>
                        </div>
                        <div ng-click="addGroupModal()" id="addGroupBtn"></div>
                                    <script type="text/ng-template" id="addGroup.html">
                                        <div ng-controller="ProfileController">
                                            <div class="modal-header">
                                                <h3 class="modal-title">Add a Group</h3>
                                            </div>
                                            <div class="modal-body">
                                            <input type="text" ng-model="newGroupName" placeholder="Group Name">
                                            <br>
                                            <label for="groupColor">Select a Color</label>
                                                
                                            <ul id="groupColorSelect">
                                                <li style = "background:#B9F5FF;" ng-click="groupColor='#B9F5FF'"></li>
                                                <li style = "background:#B5FBA3;" ng-click="groupColor='#B5FBA3'"></li>
                                                <li style = "background:#FFA6B1;" ng-click="groupColor='#FFA6B1'"></li>
                                                <li style = "background:#FEC12F;" ng-click="groupColor='#FEC12F'"></li>
                                            </ul>    
                                                
                                            </div>
                                            <div class="modal-footer">
                                                <button class="btn btn-primary" ng-click="createGroup(); cancel()">OK</button>
                                                <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                                            </div>
                                        </div>
                                    </script>
                        
                        <script type="text/ng-template" id="addGroup.html">
                            <div ng-controller="ProfileController">
                                <div class="modal-header">
                                    <h3 class="modal-title">Add a Group</h3>
                                </div>
                                <div class="modal-body">
                                <input type="text" ng-model="newGroupName" placeholder="Group Name">
                                <br>
                                <br>
                                <label for="groupColor">Select a Color</label>

                                <ul id="groupColorSelect">
                                    <li style = "background:#B9F5FF;" ng-click="groupColor='#B9F5FF'"></li>
                                    <li style = "background:#B5FBA3;" ng-click="groupColor='#B5FBA3'"></li>
                                    <li style = "background:#FFA6B1;" ng-click="groupColor='#FFA6B1'"></li>
                                    <li style = "background:#FEC12F;" ng-click="groupColor='#FEC12F'"></li>
                                </ul>    

                                <br>
                                    
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-primary" ng-click="createGroup(); cancel()">OK</button>
                                    <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                                </div>
                            </div>
                        </script>
                	</ul>
            	</div>
        	</div>
        </div> 
      </div> <!--END PROFILE CONTROLLER -->
        <!-- GROUP CONTROLLER -->
        <div class="singleGroupView" ng-init="singleGroupView=false" ng-show="singleGroupView">
            <div id="profileWrapper" ng-controller="GroupController">
                <p id = "groupName" ng-style="{background:groupColor}">{{ groupName }}</p>
                <div style="clear:both;">
                <div id="scheduleWrapper" >
                    <p id="yourSched">Your Schedule</p>
            
                    <div class="schedule">
                        <!-- TEST group UI CALENDAR -->
                         <div  ng-model="eventSources" calendar='groupCalendar' ui-calendar="uiConfig.calendar"  ></div> 
                        <br><br>
                    </div>
                </div>
                
                <div id="createWrapper">
                    <p id="createTitle">Create Event</p>
                    <div class="createEvent">
                        <label for="gEventName">Event Name</label>
                        <input type="text" name="gEventName" class="eventPar" ng-model="newEventName"><br><br>
                        
                        <label for="gStartTime">Start Time</label>
                        <input type="time" name="gStartTime" class="eventPar" ng-model="lol"><br><br>
                        
                        <label for="gEndTime">End Time</label>
                        <input type="time" name="gEndTime" class="eventPar" ng-model="lol2"><br><br>
                        
                        <label for="gStartDate">Start Date</label>
                        <input type="date" name="gStartDate" class="eventPar" ng-model="lol3"><br><br>
                        
                        <label for="gEndDate">End Date</label>
                        <input type="date" name="gEndDate" class="eventPar" ng-model="lol3"><br><br>
                        
                        <div ng-click="" class="createButton" style="margin-top:10px;">Create</div>
                    </div>
                </div>
                    </div>
                
                <div id="membersInfo">
                    <h2>Members</h2>
                    <div class = "members" ng-repeat="member in memberList track by $index"> {{member.name}} </div>
                    <br><br><br><br><br><br>
                    <div ng-click="addMember()" class="btn2" style="margin-top:10px;">Add New Member</div>
                    <input type="text" ng-model="newMemberEmail" placeholder="New Member Email">
                    <br><br>
        	   </div>
            </div>   
        </div>
    </body>
</html>
