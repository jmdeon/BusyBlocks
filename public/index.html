<html ng-app="myApp" style="background:#FCFAF8;">
    <head style="background: #FCFAF8;">
        <!-- Information about the document goes here. This includes the encoding, title, css files, and JS files -->
        <link rel="stylesheet" type="text/css" href="./style.css">
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.0/angular-material.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">	
        <title>Scheduling App</title>



        <!-- Get access to the Parse library -->
		<script type="text/javascript" src="https://parse.com/downloads/javascript/parse-1.4.2.js"></script>

        <!-- Load UI Calendar sources -->
        <link rel="stylesheet" href="lib/bower_components/fullcalendar/dist/fullcalendar.css"/>

        <!-- jquery, moment, and angular have to get included before fullcalendar -->
        <script type="text/javascript" src="lib/bower_components/jquery/dist/jquery.js"></script>
        <script type="text/javascript" src="lib/bower_components/moment/moment.js"></script>
        <script type="text/javascript" src="lib/moment-recur.min.js"></script>
        <script type="text/javascript" src="lib/bower_components/angular/angular.js"></script>
        <script type="text/javascript" src="lib/bower_components/angular-ui-calendar/src/calendar.js"></script>
        <script type="text/javascript" src="lib/bower_components/fullcalendar/dist/fullcalendar.js"></script>
        <script type="text/javascript" src="lib/bower_components/fullcalendar/dist/gcal.js"></script>

        <!-- Load BootStrap -->
        <script type="text/javascript" src="lib/ui-bootstrap-tpls-0.13.0.min.js"></script>

        <!-- Load accordian bootstrap -->
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.13/angular.js"></script>
        <script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.13.0.js"></script>
        <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">

        <!-- Modules -->
        <script src="js/app.js"></script>
        <!-- Controllers -->
    	<script src="js/controllers/ProfileController.js"></script>
        <script src="js/controllers/GroupController.js"></script>
        <!-- Services -->
        <script src="js/services/dataBaseService.js"></script>
    	<script src="js/services/userService.js"></script>
    	<script src="js/services/groupService.js"></script>
        <script src="js/services/eventService.js"></script>

        <!-- Inline JS goes here -->
        <script> 
            /** Global variables **/
            Parse.initialize( "t5hvXf3wJOYnL3MMIffsemMdhLM7f4brACcf0eBa", "UhqQaEDIEQr6cxhO8XS4Fl8BcGU4ir9jL9To7PVO" );
            var currentUser = Parse.User.current();
            if (currentUser) {
            	// do stuff with the user
            } 
            else {
            	// show the signup or login page
            	location.href = "login/login.html";
            }
            
        </script> 
    </head>
    
    <body style="background: #FCFAF8;">
      <!-- PROFILE CONTROLLER -->
      <div ng-controller="ProfileController"> 
        
        <script type="text/ng-template" id="myModalContent.html">
<!--
            <div class="modal-header">
                <h3 class="modal-title">Add a Friend</h3>
-->
<!--            </div>-->
            <div class="modal-body">
<!--            	<label for="friendEmail">Friend&#39;s Email</label>-->
            	<input placeholder = "Enter Friend's Email" type="text" name="friendEmail">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" ng-click="ok()">OK</button>
                <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
            </div>
        </script>

        <script type="text/ng-template" id="friendList.html">
        	<div ng-controller="ProfileController">
	            <div class="modal-header">
	                <h3 class="modal-title">Your Friends</h3>
	            </div>
	            <div class="modal-body">
	                <ul>
	                    <li ng-repeat="friend in friendList track by $index">{{ friend.name }} ({{ friend.email }})</li>
	                </ul>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-primary" ng-click="ok()">OK</button>
	                <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
	            </div>
           	</div>
        </script>

        <script type="text/ng-template" id="editEvent.html">
            <div ng-controller="ProfileController">
                <div>
                    <div  style="background-color:{{ eventClicked.color}}" class="modal-header">
                        <h3 class="modal-title">{{ eventClicked.title }}</h3>
                    </div>
                    <div class="modal-body">
                        <div>{{ eventClicked.start.format("MMMM DD, YYYY")}} to {{ eventClicked.end.format("MMMM DD, YYYY")}}</div>
                        <div>{{ eventClicked.start.format("hh:mm a")}} to {{ eventClicked.end.format("hh:mm a")}}</div>
                        <label>Modify Event Name</label>
                        <input type="text" ng-model="editEventName" placeholder={{eventClicked.title}}>
                        <label>Modify Color</label>
                        <input type="text" ng-model="editEventColor" placeholder={{eventClicked.color}}>
                    
                        
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" ng-click="editEvent();saveLabel=true;cancel()">Save</button>
                        <button class="btn btn-primary" ng-click="deleteEvent();cancel()">Delete</button>
                        <button class="btn btn-warning" ng-click="cancel()">Close</button>
                    </div>
                </div>
            </div>
        </script>

        <script type="text/ng-template" id="settings.html">
            <div ng-controller="ProfileController">
                <div class="modal-header">
                    <h3 class="modal-title">Account Settings</h3>
                </div>
                <div class="modal-body">
                    <tabset>
                        <tab heading="Profile">
                            <br>
                            <center>
                                <div id="lblSave" ng-show="saveLabel">Your settings saved successfully :]</div>
                                <div id="lblError" ng-show="errLabel">Error saving settings :[</div>
                            </center>
                            <input style="margin-bottom:15px;" placeholder="Enter New UserName" ng-model="newUserName"><br>
                            <input style="margin-bottom:15px;" placeholder="Enter New Email" ng-model="newEmail"><br>
                            <input style="margin-bottom:15px;" placeholder="Enter New Password" type="password" ng-model="newPassword"><br><br>
                            <div ng-controller="CollapseInstanceCtrl">
                                <button class="btn btn-default" ng-click="isCollapsed=!isCollapsed">Choose User Icons</button><br><br>
                                <div collapse="isCollapsed">
                                    <div class="well" id="colIcons">
                                        <h2 text-align="center">Select a user icon</h2>
                                        <div id="icons" ng-repeat="icon in icons track by $index" ng-attr-title="{{icon.name}}">
                                            <img class="selIcons" ng-src="{{icon.image}}" ng-click="clearSel($event);" 
                                                 ng-class="{'selected': icon.selected, 'smallIcon': icon.name==='Super Hero'}"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tab>
                        <tab heading="Google Calendar">
                            <br>
                            <input style="margin-bottom:15px;" placeholder="Enter Google Calendar ID" ng-model="googleCalendarID"><br>
                            <div>
                                <accordion close-others="oneAtATime">
                                    <accordion-group heading="How to Get Your Google Calendar ID">
                                        <p>Make your Google Calendar public:
                                            <ol>
                                                <li>In the Google Calendar interface, locate the "My calendars" area on the left.</li>
                                                <li>Hover over the calendar you need and click the downward arrow. </li>
                                                <li>A menu will appear. Click "Share this Calendar".</li>
                                                <li>Check "Make this calendar public".</li>
                                                <li>Make sure "Share only my free/busy information" is unchecked.</li>
                                                <li>Click "Save".</li>
                                            </ol>
                                            Obtain your Google Calendar ID:<br>
                                            <ol>
                                                <li>In the Google Calendar interface, locate the "My calendars" area on the left.</li>
                                                <li>Hover over the calendar you need and click the downward arrow.</li> 
                                                <li>A menu will appear. Click "Calendar settings".</li>
                                                <li>In the "Calendar Address" section of the screen, you will see your Calendar ID. It will look something like "abcd1234@group.calendar.google.com".</li>              
                                        </p><br>
                                    </accordion-group>
                                </accordion>
                            </div>
                        </tab>
                        <tab heading="Remove All Events">
                            <br>
                            <center><div id="remEvents" ng-show="remLabel">All events removed!</div></center>
                            <p>Please type the following to clear all your events: "clear my events!"</p>
                            <input ng-model="clearEvents" placeholder="clear my events!" ng-pattern="clear my events!" ng-style="( clearEvents.length == 0 || !clearEvents ) ? { 'border-bottom':'1px solid #c6c6c6' } : ( (clearEvents) ? { 'border-bottom':'1px solid green' } : { 'border-bottom':'1px solid red' } )">
                            <br><br>
                            <div ng-click="removeAllEvents()" id="remEvents">Remove All Personal Events</div>
                        </tab>
                    </tabset><br>
                </div>
                <div class="modal-footer">
                	<button class="btn btn-primary" ng-click="settingsSave();">Save</button>
                    <button class="btn btn-warning" ng-click="cancel()">Close</button>
                </div>
            </div>
        </script>
          
        <div id="logoutWrapper">
            <div class="btn-group" dropdown>
                <div class="logoutbtn" ng-show="homeView" dropdown-toggle></div>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a ng-click="settingsModal('lg')">Account Settings</a></li>
                        <li><a ng-click="logout()">Logout</a></li>
                    </ul>
            </div>
            
            <div class="btn-group" dropdown>
                <div class = "friendsOptionsBtn" ng-show="homeView" dropdown-toggle></div>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a ng-click="open('lg')">Add Friend</a></li>
                        <li><a ng-click="friendsModal('lg')">View Friends List</a></li>
                    </ul>
            </div>
            
            <div id="greeting">Hi, {{ userName }}</div>
            <center>
                <div ng-click="profileView=true; groupView=false; $parent.singleGroupView=false" ng-class="{selTab: profileView}" class="viewBtn">Personal</div>
                <div ng-click="groupView=true; profileView=false; $parent.singleGroupView=false" ng-class="{selTab: groupView}" class="viewBtn">Groups</div>
                <div ng-hover="" ng-click="profileView=false; groupView=false; $parent.singleGroupView=true;" class="viewBtn" ng-class="{selTab: $parent.singleGroupView}" ng-hide="!singleGroupName">
                    {{ singleGroupName | limitTo:8 }}{{ singleGroupName.length > 8 ? '...' : '' }}
                </div>
            </center>
        </div>
    
        <div id="homeView" ng-init="homeView=true" ng-show="homeView">     
        	<div ng-init="profileView=true" ng-show="profileView" id="profileView">
            	<div id="profileWrapper">
                    <div id="scheduleWrapper">
                        <p id="yourSched">Your Schedule</p>
                
                        <div class="schedule card">
                            <!-- TEST UI CALENDAR -->
                            <div  ng-model="eventSources" calendar='userCalendar' ui-calendar="uiConfig.calendar" ></div>
                            <br><br>
                        </div>
                    </div>
                    
                    <div id="createWrapper">
                        <p id="createTitle">Create Personal Event</p>
                        <div class="createEvent card">
<!--                            <p >Event Name</p>-->
                            <input placeholder="Event Name" type="text" name="pEventName" class="eventPar" ng-model="newEventName">
                            <br><br>

                            <div ng-controller="PopoverInstanceCtrl">
                                <center><button Popover-animation="true" popover-template="repDays.templateUrl" popover-placement="top" class="btn btn-default" popover-title="Select Repeating Days">Set Repeating</button></center>
                                <script type="text/ng-template" id="repDays.html">
                                    <div class="repDays">
                                        <label class="btn btn-primary" ng-model="dayRepeat.monday" btn-checkbox>Mon</label><label class="btn btn-primary" ng-model="dayRepeat.tuesday" btn-checkbox>Tue</label><label class="btn btn-primary" ng-model="dayRepeat.wednesday" btn-checkbox>Wed</label><label class="btn btn-primary" ng-model="dayRepeat.thursday" btn-checkbox>Thu</label><label class="btn btn-primary" ng-model="dayRepeat.friday" btn-checkbox>Fri</label><label class="btn btn-primary" ng-model="dayRepeat.saturday" btn-checkbox>Sat</label><label class="btn btn-primary" ng-model="dayRepeat.sunday" btn-checkbox>Sun</label>
                                    </div>
                                </script>
                            </div>
                            <!-- <label for="repeatingEvent" class="eventPar" style="border:none">Repeat Weekly</label>
                            <input ng-init="repeatingEvent=false" type="checkbox" name="repeatingEvent" ng-click="repeatingEvent = !repeatingEvent"> -->
                            <br>

                            <p>Start Date: <input  ng-init="eventStartDate=Date()" name="pStartDate" type="date" class="eventPar" ng-model="eventStartDate"></p>
                            
                            <br>
                            
                            <p>End Date: <input ng-init="eventEndDate=Date()" for="pEndDate" type="date" class="eventPar" ng-model="eventEndDate">
                            
                            <br>

                            <p>Start Time: </p>
                            <center><timepicker ng-init ="eventStartTime" ng-model="eventStartTime" ng-change="changed()" hour-step="hstep" minute-step="mstep" show-meridian="ismeridian"></timepicker></center>

                            <p>End Time: </p>
                            <center><timepicker ng-init ="eventEndTime"  ng-model="eventEndTime" ng-change="changed()" hour-step="hstep" minute-step="mstep" show-meridian="ismeridian"></timepicker></center>
                            <br>
                            <div ng-controller="PopoverInstanceCtrl">
                                <center><button Popover-animation="true" popover-template="groupColorSelect.templateUrl" popover-placement="top" class="btn btn-default" ng-style="{'background':eventColor.mine}" ng-init="eventColor.mine='#fff'" popover-trigger="focus" popover-title="Select Color" id="colorBtn">Choose A Color</button></center>
                                <script type="text/ng-template" id="groupColorSelect.html">
                                    <div id="groupColorSelect">
                                        <div style="background:#B9F5FF;" ng-click="eventColor.mine='#B9F5FF'"></div>
                                        <div style="background:#B5FBA3;" ng-click="eventColor.mine='#B5FBA3'"></div>
                                        <div style="background:#FFA6B1;" ng-click="eventColor.mine='#FFA6B1'"></div>
                                        <div style="background:#FEC12F;" ng-click="eventColor.mine='#FEC12F'"></div>
                                        <div style="background:#F06292;" ng-click="eventColor.mine='#F06292'"></div>
                                        <div style="background:#CE93D8;" ng-click="eventColor.mine='#CE93D8'"></div>
                                        <div style="background:#9575CD;" ng-click="eventColor.mine='#9575CD'"></div>
                                        <div style="background:#7986CB;" ng-click="eventColor.mine='#7986CB'"></div>
                                        <div style="background:#81D4FA;" ng-click="eventColor.mine='#81D4FA'"></div>
                                        <div style="background:#4DD0E1;" ng-click="eventColor.mine='#4DD0E1'"></div>
                                        <div style="background:#4DB6AC;" ng-click="eventColor.mine='#4DB6AC'"></div>
                                        <div style="background:#D4E157;" ng-click="eventColor.mine='#D4E157'"></div>
                                        <div style="background:#FFF176;" ng-click="eventColor.mine='#FFF176'"></div>
                                        <div style="background:#FFD54F;" ng-click="eventColor.mine='#FFD54F'"></div>
                                        <div style="background:#FFA726;" ng-click="eventColor.mine='#FFA726'"></div>
                                        <div style="background:#FD8964;" ng-click="eventColor.mine='#FD8964'"></div>
                                        <div style="background:#BDBDBD;" ng-click="eventColor.mine='#BDBDBD'"></div>
                                        <div style="background:#90A4AE;" ng-click="eventColor.mine='#90A4AE'"></div>
                                        <br>
                                    </div>
                                </script>
                            </div>
                            
                            <br>
                                
                            <div ng-click="createEvent()" class="createButton" style="margin-top:10px;">Create</div>
                            
                        </div>
                    </div>
            	</div>
        	</div>
            
        	<div ng-init="groupView=false" ng-show="groupView" id="groupView">
            	<div>
<!--                	<div ng-click="removeAllGroups()" class="btn2">Remove ALL Group</div>-->
                            <div ng-repeat="group in myGroupList track by $index" class ="groupSelect card"  
                               ng-style="{background:group.color}">

                                <div id = "groupClick"
                                     ng-click="$parent.profileView=false; 
                                      $parent.groupView=false; 
                                      $parent.$parent.singleGroupView=true; 
                                      $parent.currentGroupId = group.id; 
                                      $parent.currentGroupColor = group.color;
                                      addGroup(); $parent.updateSingleGroupTab(group.name)" ng-attr-title="{{ group.name }}" >
                                    <p>{{ group.name | limitTo:12 }}{{ group.name.length > 12 ? '...' : '' }}</p>
                                </div>
                                <div ng-controller="PopoverInstanceCtrl">
                                <div Popover-animation="true" id="pencil"></div> 
                                <div Popover-animation="true" popover-template="confirmRemove.templateUrl" popover-trigger="focus" 
                                     popover-placement="bottom" id="minus" popover-title="Confirm Remove" tabindex="0"></div>
                                <script type="text/ng-template" id="confirmRemove.html">
                                    <button class="btn btn-danger" ng-click="removeGroup(group.id);">Delete</button>
                                </script>
                            </div>
                            </div>
    
                        <div ng-click="addGroupModal()" id="addGroupBtn"></div>
                        <script type="text/ng-template" id="addGroup.html">
                            <div ng-controller="ProfileController">
                                <div class="modal-header">
                                    <h3 class="modal-title">Add a Group</h3>
                                </div>
                                <div class="modal-body">
                                <input type="text" ng-model="newGroupName" placeholder="Enter Group Name">
                                <br><br>
                                <label for="groupColor">Select a Color</label>
                                    
                                <div id="groupColorSelect">
                                    <div style="background:#B9F5FF;" ng-click="groupColor='#B9F5FF'"></div>
                                    <div style="background:#B5FBA3;" ng-click="groupColor='#B5FBA3'"></div>
                                    <div style="background:#FFA6B1;" ng-click="groupColor='#FFA6B1'"></div>
                                    <div style="background:#FEC12F;" ng-click="groupColor='#FEC12F'"></div>
                                </div>    
                                <br><br>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-primary" ng-click="createGroup(); cancel()">OK</button>
                                    <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                                </div>
                            </div>
                        </script>

            	</div>
        	</div>
        </div> 
      </div> <!--END PROFILE CONTROLLER -->
        <!-- GROUP CONTROLLER -->
        <div class="singleGroupView" ng-init="singleGroupView=false" ng-show="singleGroupView">
            <div id="profileWrapper" ng-controller="GroupController">
<!--
                <div id="groupHeader" ng-style="{background:groupColor}">
                    <p id="groupName">{{ groupName }}</p>
                    <button class="btn btn-info">Members</button>
                </div>
-->
                <div style="clear:both;">
                    <div id="scheduleWrapper" style="top:0px;">
                        <p id="yourSched">Group Schedule</p>
                        <div class="schedule card">
                            <!-- TEST group UI CALENDAR -->
                            <div  ng-model="eventSources" calendar='groupCalendar' ui-calendar="uiConfig.calendar"  ></div> 
                            <br><br>
                        </div>
                    </div>
                
                    <div id="createWrapper" style="top:0px;">
                        <p id="createTitle">Create Group Event</p>
                        <div class="createEvent card">
                            <!-- <p >Event Name</p> -->
                            <input type="text" placeholder="Event Name" name="pEventName" class="eventPar" ng-model="newEventName">
                            <br><br>

                            <div ng-controller="PopoverInstanceCtrl">
                                <center><button Popover-animation="true" popover-template="repDays.templateUrl" popover-placement="bottom" class="btn btn-default" popover-title="Select Repeating Days">Set Repeating</button></center>
                                <script type="text/ng-template" id="repDays.html">
                                    <div class="repDays">
                                    <label class="btn btn-primary" ng-model="dayRepeat.monday" btn-checkbox>Mon</label><label class="btn btn-primary" ng-model="dayRepeat.tuesday" btn-checkbox>Tue</label><label class="btn btn-primary" ng-model="dayRepeat.wednesday" btn-checkbox>Wed</label><label class="btn btn-primary" ng-model="dayRepeat.thursday" btn-checkbox>Thu</label><label class="btn btn-primary" ng-model="dayRepeat.friday" btn-checkbox>Fri</label><label class="btn btn-primary" ng-model="dayRepeat.saturday" btn-checkbox>Sat</label><label class="btn btn-primary" ng-model="dayRepeat.sunday" btn-checkbox>Sun</label>
                                    </div>
                                </script>
                            </div>
                            <br>

                            <p>Start Date: <input  ng-init="eventStartDate=Date()" name="pStartDate" type="date" class="eventPar" ng-model="eventStartDate"></p>
                            
                            <br>
                            
                            <p>End Date: <input ng-init="eventEndDate=Date()" for="pEndDate" type="date" class="eventPar" ng-model="eventEndDate"></p>
                            
                            <br>

                            <p >Start Time</p>
                            <!-- <input ng-init="eventStartTime = Date()" type="time" class="eventPar" ng-model="eventStartTime"> --> 
                            <center><timepicker ng-init ="eventStartTime" ng-model="eventStartTime" ng-change="changed()" hour-step="hstep" minute-step="mstep" show-meridian="ismeridian"></timepicker></center>

                            <p >End Time</p>
                            <!-- <input ng-init="eventEndTime = Date(1)"  type="time" class="eventPar" ng-model="eventEndTime"> -->
                            <center><timepicker ng-init ="eventEndTime" ng-model="eventEndTime" ng-change="changed()" hour-step="hstep" minute-step="mstep" show-meridian="ismeridian"></timepicker></center>
                            
                            <div ng-click="createEvent()" class="createButton" style="margin-top:10px;">Create</div>
                        </div>
                    </div>
                
                    <div id="membersInfo">
                        <h5><strong>Group Code: </strong></h5>
                        <p>{{currentGroupId}}</p>
                        <h2>Members</h2>
                        <div class="members" ng-repeat="member in memberList track by $index">
                            <img class="memberIcon" ng-src="{{member.icon}}"/>
                    	   <p text-align="center">{{member.name}}</p>
                        </div>
                        <div id = "addMemberBtn" ng-click="addMemberModal()"></div>
                        <script type="text/ng-template" id="addMember.html">
                            <div ng-controller="GroupController">
                                <div class="modal-header">
                                    <h3 class="modal-title">Add a Member</h3>
                                </div>
                                <div class="modal-body">
                                    <input type="text" ng-model="newMemberEmail" placeholder="Add New Member Email"> 
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-primary" ng-click="addMember()">OK</button>
                                    <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                                </div>
                            </div>
                        </script>
                    </div>  
                </div>
            </div>
        </div>
    </body>
</html>
